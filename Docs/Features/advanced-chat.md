# Chat NÃ¢ng cao

## Tá»•ng quan

TÃ­nh nÄƒng Chat NÃ¢ng cao má»Ÿ rá»™ng kháº£ nÄƒng giao tiáº¿p trong lá»›p há»c vá»›i há»— trá»£ nhÃ³m chat tÃ¹y chá»‰nh, gá»­i hÃ¬nh áº£nh vÃ  file Ä‘Ã­nh kÃ¨m.

## CÃ¡c tÃ­nh nÄƒng

### 1. Chat CÃ¡ nhÃ¢n (1-1)

- GiÃ¡o viÃªn chat riÃªng vá»›i tá»«ng há»c sinh
- Há»c sinh cÃ³ thá»ƒ gá»­i tin nháº¯n cho giÃ¡o viÃªn
- Lá»‹ch sá»­ chat Ä‘Æ°á»£c lÆ°u trá»¯ theo phiÃªn

### 2. NhÃ³m Chat TÃ¹y chá»‰nh

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Táº O NHÃ“M CHAT                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  âš ï¸ LÆ°u Ã½: Chá»‰ GiÃ¡o viÃªn má»›i cÃ³ thá»ƒ táº¡o nhÃ³m chat          â”‚
â”‚                                                             â”‚
â”‚  1. GiÃ¡o viÃªn click [+ Táº¡o nhÃ³m] trong ChatView             â”‚
â”‚                      â”‚                                      â”‚
â”‚                      â–¼                                      â”‚
â”‚  2. Nháº­p tÃªn nhÃ³m: "NhÃ³m ToÃ¡n nÃ¢ng cao"                    â”‚
â”‚                      â”‚                                      â”‚
â”‚                      â–¼                                      â”‚
â”‚  3. Chá»n thÃ nh viÃªn tá»« danh sÃ¡ch há»c sinh                  â”‚
â”‚     â˜‘ Nguyá»…n VÄƒn A                                         â”‚
â”‚     â˜‘ Tráº§n Thá»‹ B                                           â”‚
â”‚     â˜ LÃª HoÃ ng C                                           â”‚
â”‚                      â”‚                                      â”‚
â”‚                      â–¼                                      â”‚
â”‚  4. Click [Táº¡o nhÃ³m]                                       â”‚
â”‚                      â”‚                                      â”‚
â”‚                      â–¼                                      â”‚
â”‚  5. NhÃ³m xuáº¥t hiá»‡n trong danh sÃ¡ch chat                    â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. Gá»­i HÃ¬nh áº£nh

- Há»— trá»£ Ä‘á»‹nh dáº¡ng: JPG, PNG, GIF, BMP
- KÃ­ch thÆ°á»›c tá»‘i Ä‘a: 10MB
- Preview hÃ¬nh trÆ°á»›c khi gá»­i
- CÃ³ thá»ƒ paste trá»±c tiáº¿p tá»« clipboard (Ctrl+V)

```
Quy trÃ¬nh gá»­i hÃ¬nh:

1. Click icon [ğŸ“·] trong Ã´ nháº­p tin nháº¯n
        â”‚
        â–¼
2. Chá»n hÃ¬nh tá»« mÃ¡y tÃ­nh hoáº·c paste clipboard
        â”‚
        â–¼
3. Preview hÃ¬nh áº£nh
        â”‚
        â–¼
4. ThÃªm caption (tÃ¹y chá»n)
        â”‚
        â–¼
5. Click [Gá»­i]
        â”‚
        â–¼
6. HÃ¬nh Ä‘Æ°á»£c nÃ©n vÃ  gá»­i Ä‘áº¿n nhÃ³m/ngÆ°á»i nháº­n
```

### 4. Gá»­i File Ä‘Ã­nh kÃ¨m

- Há»— trá»£ táº¥t cáº£ Ä‘á»‹nh dáº¡ng file
- KÃ­ch thÆ°á»›c tá»‘i Ä‘a: 50MB
- Hiá»ƒn thá»‹ icon theo loáº¡i file
- NgÆ°á»i nháº­n click Ä‘á»ƒ táº£i vá»

```
CÃ¡c loáº¡i file Ä‘Æ°á»£c há»— trá»£:

| Icon | Loáº¡i file                    |
|------|------------------------------|
| ğŸ“„   | Document (doc, docx, pdf)    |
| ğŸ“Š   | Spreadsheet (xls, xlsx)      |
| ğŸ“‘   | Presentation (ppt, pptx)     |
| ğŸ–¼ï¸   | Image (jpg, png, gif)        |
| ğŸµ   | Audio (mp3, wav)             |
| ğŸ¬   | Video (mp4, avi)             |
| ğŸ“¦   | Archive (zip, rar)           |
| ğŸ“   | Code (py, js, cs)            |
| ğŸ“   | Other                        |
```

## Giao diá»‡n

### ChatView (Teacher & Student)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ’¬ Chat                                              â”€ â–¡ Ã— â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ NHÃ“M            â”‚  â† Lá»›p 10A1                    25 online  â”‚
â”‚                 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â— Lá»›p 10A1  (3) â”‚                 HÃ´m nay                    â”‚
â”‚ â—‹ NhÃ³m ToÃ¡n     â”‚                                            â”‚
â”‚ â—‹ NhÃ³m VÄƒn      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚                 â”‚  â”‚ ğŸ‘¤ Tháº§y Minh                10:01   â”‚   â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  â”‚ CÃ¡c em xem hÃ¬nh nÃ y nhÃ©             â”‚   â”‚
â”‚ CHAT RIÃŠNG      â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚   â”‚
â”‚                 â”‚  â”‚ â”‚    [HÃ¬nh minh há»a]     â”‚          â”‚   â”‚
â”‚ â— Nguyá»…n VÄƒn A  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚   â”‚
â”‚ â—‹ Tráº§n Thá»‹ B    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                 â”‚                                            â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ [+ Táº¡o nhÃ³m]    â”‚             â”‚ Dáº¡ em hiá»ƒu rá»“i áº¡! ğŸ™Œ    â”‚   â”‚
â”‚ (Chá»‰ GV)        â”‚             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                 â”‚                              10:02 âœ“âœ“      â”‚
â”‚                 â”‚                                            â”‚
â”‚                 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                 â”‚ [ğŸ“·][ğŸ“] [Nháº­p tin nháº¯n...        ] [â¤]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Dialog Táº¡o NhÃ³m

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“ Táº¡o NhÃ³m Chat Má»›i                                   Ã— â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  TÃªn nhÃ³m: [NhÃ³m Ã”n táº­p ToÃ¡n                         ]     â”‚
â”‚                                                              â”‚
â”‚  Chá»n thÃ nh viÃªn:                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ [ğŸ” TÃ¬m kiáº¿m...]                                       â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚ â˜‘ Nguyá»…n VÄƒn An          â—‹ Online                     â”‚ â”‚
â”‚  â”‚ â˜‘ Tráº§n Thá»‹ BÃ¬nh          â— Offline                    â”‚ â”‚
â”‚  â”‚ â˜ LÃª HoÃ ng CÆ°á»ng         â—‹ Online                     â”‚ â”‚
â”‚  â”‚ â˜‘ Pháº¡m Thu Dung          â—‹ Online                     â”‚ â”‚
â”‚  â”‚ â˜ VÃµ Minh Em             â— Offline                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                              â”‚
â”‚  ÄÃ£ chá»n: 3 há»c sinh                                        â”‚
â”‚                                                              â”‚
â”‚                              [Táº¡o nhÃ³m]    [Há»§y]            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Protocol Messages

### MessageType má»›i

| Code | Type             | MÃ´ táº£                      |
|------|------------------|----------------------------|
| 0x32 | ChatGroupCreate  | Táº¡o nhÃ³m chat má»›i          |
| 0x33 | ChatGroupInvite  | Má»i thÃªm thÃ nh viÃªn        |
| 0x34 | ChatGroupLeave   | Rá»i khá»i nhÃ³m              |
| 0x35 | ChatGroupList    | Danh sÃ¡ch nhÃ³m             |
| 0x36 | ChatImageMessage | Tin nháº¯n cÃ³ hÃ¬nh           |
| 0x37 | ChatFileMessage  | Tin nháº¯n cÃ³ file Ä‘Ã­nh kÃ¨m  |

### Payload Format

```json
// ChatGroupCreate
{
  "groupId": "uuid",
  "name": "NhÃ³m ToÃ¡n",
  "memberIds": ["student-1", "student-2"],
  "creatorId": "teacher-1"
}

// ChatImageMessage
{
  "groupId": "uuid",
  "senderId": "teacher-1",
  "imageData": "base64-encoded-image",
  "fileName": "screenshot.png",
  "caption": "HÃ¬nh minh há»a"
}

// ChatFileMessage
{
  "groupId": "uuid",
  "senderId": "student-1",
  "fileId": "uuid",
  "fileName": "baitap.docx",
  "fileSize": 1024000,
  "message": "Em ná»™p bÃ i áº¡"
}
```

## Database Tables

```sql
-- NhÃ³m chat
CREATE TABLE ChatGroups (
    id TEXT PRIMARY KEY,
    name TEXT NOT NULL,
    creator_id TEXT NOT NULL,
    session_id INTEGER,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (session_id) REFERENCES Sessions(id)
);

-- ThÃ nh viÃªn nhÃ³m
CREATE TABLE ChatGroupMembers (
    group_id TEXT,
    member_id TEXT,
    member_name TEXT,
    joined_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    PRIMARY KEY (group_id, member_id)
);

-- File/HÃ¬nh Ä‘Ã­nh kÃ¨m
CREATE TABLE ChatAttachments (
    id TEXT PRIMARY KEY,
    message_id INTEGER,
    file_name TEXT NOT NULL,
    file_path TEXT NOT NULL,
    file_size INTEGER,
    content_type TEXT,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (message_id) REFERENCES ChatMessages(id)
);
```

## PhÃ­m táº¯t

| PhÃ­m táº¯t        | Chá»©c nÄƒng              |
|-----------------|------------------------|
| `Enter`         | Gá»­i tin nháº¯n           |
| `Shift + Enter` | Xuá»‘ng dÃ²ng             |
| `Ctrl + V`      | Paste áº£nh/file         |
| `Ctrl + I`      | ChÃ¨n hÃ¬nh áº£nh          |
| `Ctrl + A`      | ÄÃ­nh kÃ¨m file          |
| `Esc`           | ÄÃ³ng cá»­a sá»• chat       |

## Giá»›i háº¡n

| ThÃ´ng sá»‘              | GiÃ¡ trá»‹    |
|-----------------------|------------|
| Sá»‘ thÃ nh viÃªn nhÃ³m    | 50 max     |
| KÃ­ch thÆ°á»›c hÃ¬nh       | 10 MB      |
| KÃ­ch thÆ°á»›c file       | 50 MB      |
| Äá»™ dÃ i tin nháº¯n       | 5000 kÃ½ tá»± |
| Sá»‘ nhÃ³m má»—i phiÃªn     | 20 nhÃ³m    |

---

_Xem thÃªm: [Workflow phÃ¡t triá»ƒn](../../.agent/workflows/new-features-development.md)_
