<Window x:Class="ClassroomManagement.Views.ChatWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        mc:Ignorable="d"
        Title="Chat nhÃ³m" 
        Height="650" Width="450"
        MinHeight="500" MinWidth="380"
        WindowStartupLocation="CenterScreen"
        Background="Transparent"
        AllowsTransparency="True"
        WindowStyle="None">
    
    <Window.Resources>
        <Style x:Key="ReceivedMessageBubbleStyle" TargetType="Border">
            <Setter Property="Background" Value="#F5F5F5"/>
            <Setter Property="CornerRadius" Value="0,12,12,12"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="Margin" Value="0,0,48,0"/>
        </Style>
        
        <Style x:Key="SentMessageBubbleStyle" TargetType="Border">
            <Setter Property="Background" Value="{StaticResource AppPrimaryBrush}"/>
            <Setter Property="CornerRadius" Value="12,0,12,12"/>
            <Setter Property="Padding" Value="12,8"/>
             <Setter Property="Margin" Value="48,0,0,0"/>
        </Style>
    </Window.Resources>

    <Border CornerRadius="8" Background="White" BorderBrush="#E0E0E0" BorderThickness="1">
        <Border.Effect>
            <DropShadowEffect BlurRadius="15" ShadowDepth="5" Color="Black" Opacity="0.15"/>
        </Border.Effect>

        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            
            <!-- ============================================ -->
            <!-- HEADER -->
            <!-- ============================================ -->
            <Border Grid.Row="0" CornerRadius="8,8,0,0" MouseLeftButtonDown="Header_MouseLeftButtonDown">
                <Border.Background>
                     <SolidColorBrush Color="{StaticResource AppPrimaryColor}"/>
                </Border.Background>
                <Grid Margin="12,8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <!-- Icon -->
                    <materialDesign:PackIcon Grid.Column="0" Kind="Forum" 
                                              Width="24" Height="24" 
                                              Foreground="White" VerticalAlignment="Center" Margin="0,0,8,0"/>
                    
                    <!-- Chat Info -->
                    <StackPanel Grid.Column="1" VerticalAlignment="Center">
                        <TextBlock Text="Chat nhÃ³m - Lá»›p 10A1" FontSize="14" FontWeight="Bold" Foreground="White"/>
                        <TextBlock Text="25 thÃ nh viÃªn online" FontSize="11" Foreground="{StaticResource AppAccentBrush}" Opacity="0.9"/>
                    </StackPanel>
                    
                    <!-- Window Controls -->
                    <StackPanel Grid.Column="2" Orientation="Horizontal">
                        <Button Style="{StaticResource MaterialDesignIconButton}" Foreground="White" Width="30" Height="30"
                                ToolTip="Thu nhá»" Click="MinimizeButton_Click">
                            <materialDesign:PackIcon Kind="WindowMinimize" Width="18" Height="18"/>
                        </Button>
                        <Button Style="{StaticResource MaterialDesignIconButton}" Foreground="White" Width="30" Height="30"
                                ToolTip="PhÃ³ng to" Click="MaximizeButton_Click">
                             <materialDesign:PackIcon Kind="WindowMaximize" Width="18" Height="18"/>
                        </Button>
                        <Button Style="{StaticResource MaterialDesignIconButton}" Foreground="White" Width="30" Height="30"
                                ToolTip="ÄÃ³ng" Click="CloseButton_Click">
                             <materialDesign:PackIcon Kind="Close" Width="18" Height="18"/>
                        </Button>
                    </StackPanel>
                </Grid>
            </Border>
            
            <!-- ============================================ -->
            <!-- CHAT MESSAGES -->
            <!-- ============================================ -->
            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Padding="12">
                <StackPanel x:Name="ChatMessages">
                    
                    <!-- System Message -->
                    <Border HorizontalAlignment="Center" Margin="0,8">
                        <TextBlock Text="HÃ´m nay, 10:00 AM" FontSize="11" Foreground="#9E9E9E"/>
                    </Border>
                    
                    <!-- Received Message -->
                    <Grid Margin="0,8">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <Border Grid.Column="0" Width="32" Height="32" CornerRadius="16" 
                                Background="#E3F2FD" VerticalAlignment="Top" Margin="0,0,8,0">
                            <materialDesign:PackIcon Kind="Account" Width="18" Height="18" 
                                                      Foreground="{StaticResource AppPrimaryBrush}"
                                                      HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        
                        <StackPanel Grid.Column="1">
                            <TextBlock Text="Tráº§n VÄƒn BÃ¬nh (GV)" FontSize="11" FontWeight="SemiBold" 
                                       Foreground="{StaticResource AppPrimaryBrush}" Margin="0,0,0,2"/>
                            <Border Style="{StaticResource ReceivedMessageBubbleStyle}">
                                <TextBlock Text="ChÃ o cÃ¡c em! HÃ´m nay chÃºng ta sáº½ há»c vá» hÃ m sá»‘ báº­c 2." 
                                           TextWrapping="Wrap" FontSize="13" Foreground="#424242"/>
                            </Border>
                            <TextBlock Text="10:01 AM" FontSize="10" Foreground="#9E9E9E" Margin="2,2,0,0"/>
                        </StackPanel>
                    </Grid>
                    
                    <!-- Sent Message -->
                    <Grid Margin="0,8">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <StackPanel Grid.Column="0" HorizontalAlignment="Right">
                             <Border Style="{StaticResource SentMessageBubbleStyle}">
                                <TextBlock Text="Dáº¡ vÃ¢ng tháº§y áº¡! Em Ä‘Ã£ chuáº©n bá»‹ bÃ i rá»“i áº¡." 
                                           TextWrapping="Wrap" FontSize="13" Foreground="White"/>
                            </Border>
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,2,0,0">
                                <TextBlock Text="10:02 AM" FontSize="10" Foreground="#9E9E9E"/>
                                <materialDesign:PackIcon Kind="CheckAll" Width="12" Height="12" 
                                                          Foreground="{StaticResource AppPrimaryBrush}" Margin="4,0,0,0"/>
                            </StackPanel>
                        </StackPanel>
                    </Grid>
                    
                    <!-- Another Received Message -->
                    <Grid Margin="0,8">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <Border Grid.Column="0" Width="32" Height="32" CornerRadius="16" 
                                Background="#E8F5E9" VerticalAlignment="Top" Margin="0,0,8,0">
                            <materialDesign:PackIcon Kind="Account" Width="18" Height="18" 
                                                      Foreground="#4CAF50"
                                                      HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        
                        <StackPanel Grid.Column="1">
                            <TextBlock Text="Nguyá»…n Thá»‹ Mai" FontSize="11" FontWeight="SemiBold" 
                                       Foreground="#4CAF50" Margin="0,0,0,2"/>
                            <Border Style="{StaticResource ReceivedMessageBubbleStyle}">
                                <TextBlock Text="Tháº§y Æ¡i, em cÃ³ tháº¯c máº¯c vá» bÃ i táº­p sá»‘ 5 áº¡ ðŸ™‹" 
                                           TextWrapping="Wrap" FontSize="13" Foreground="#424242"/>
                            </Border>
                            <TextBlock Text="10:05 AM" FontSize="10" Foreground="#9E9E9E" Margin="2,2,0,0"/>
                        </StackPanel>
                    </Grid>
                    
                </StackPanel>
            </ScrollViewer>
            
            <!-- ============================================ -->
            <!-- MESSAGE INPUT -->
            <!-- ============================================ -->
            <Border Grid.Row="2" Background="White" Padding="12,16" CornerRadius="0,0,8,8" BorderBrush="#EEE" BorderThickness="0,1,0,0">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <!-- Attachment Button -->
                    <Button Grid.Column="0" Style="{StaticResource MaterialDesignIconButton}" 
                            Width="36" Height="36" ToolTip="ÄÃ­nh kÃ¨m file" Margin="0,0,8,0">
                        <materialDesign:PackIcon Kind="Attachment" Width="20" Height="20" Foreground="#757575"/>
                    </Button>
                    
                    <!-- Text Input -->
                    <Border Grid.Column="1" Background="#F5F5F5" CornerRadius="18">
                        <TextBox x:Name="MessageInput" 
                                 Style="{StaticResource MaterialDesignTextBox}"
                                 materialDesign:HintAssist.Hint="Nháº­p tin nháº¯n..."
                                 BorderThickness="0"
                                 Background="Transparent"
                                 Padding="16,10"
                                 VerticalAlignment="Center"
                                 KeyDown="MessageInput_KeyDown"/>
                    </Border>
                    
                    <!-- Send Button -->
                        <Button Grid.Column="2" 
                                Style="{StaticResource MaterialDesignFloatingActionMiniButton}"
                                Width="36" Height="36"
                                Margin="8,0,0,0"
                                Background="{StaticResource AppPrimaryBrush}"
                                BorderBrush="{StaticResource AppPrimaryBrush}"
                                Click="SendMessage_Click"
                                ToolTip="Gá»­i tin nháº¯n">
                        <materialDesign:PackIcon Kind="Send" Width="18" Height="18"/>
                    </Button>
                </Grid>
            </Border>
        </Grid>
    </Border>
</Window>
