<Window x:Class="ClassroomManagement.Views.CreatePollWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        Title="Tạo Bình Chọn" Height="500" Width="600"
        WindowStartupLocation="CenterOwner"
        TextElement.Foreground="{DynamicResource MaterialDesignBody}"
        Background="{DynamicResource MaterialDesignPaper}"
        FontFamily="{materialDesign:MaterialDesignFont}">
    <Grid Margin="16">
        <!-- Input Form -->
        <Grid x:Name="InputGrid">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <TextBlock Text="TẠO BÌNH CHỌN MỚI" Style="{StaticResource MaterialDesignHeadline6TextBlock}" Margin="0,0,0,16"/>

            <StackPanel Grid.Row="1">
                <TextBox x:Name="QuestionBox" materialDesign:HintAssist.Hint="Câu hỏi"
                         Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                         Text="Bạn nghĩ sao về bài học hôm nay?" Margin="0,0,0,24"/>

                <TextBlock Text="Các lựa chọn:" FontWeight="Bold" Margin="0,0,0,8"/>

                <ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="250">
                    <ItemsControl x:Name="OptionsControl">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBox Text="{Binding Text, UpdateSourceTrigger=PropertyChanged}"
                                             materialDesign:HintAssist.Hint="Nhập lựa chọn..."
                                             Style="{StaticResource MaterialDesignOutlinedTextBox}"/>
                                    <Button Grid.Column="1" Style="{StaticResource MaterialDesignToolButton}"
                                            Click="RemoveOption_Click" Margin="8,0,0,0">
                                        <materialDesign:PackIcon Kind="Delete" Foreground="Red"/>
                                    </Button>
                                </Grid>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </ScrollViewer>

                <Button Content="Thêm lựa chọn" Style="{StaticResource MaterialDesignOutlinedButton}"
                        HorizontalAlignment="Left" Click="AddOption_Click" Margin="0,8,0,0"/>
            </StackPanel>

            <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,16,0,0">
                <Button Content="Hủy" IsCancel="True" Style="{StaticResource MaterialDesignFlatButton}" Click="Close_Click"/>
                <Button Content="BẮT ĐẦU" Click="StartPoll_Click" Style="{StaticResource MaterialDesignRaisedButton}" Margin="8,0,0,0"/>
            </StackPanel>
        </Grid>

        <!-- Result View -->
        <Grid x:Name="ResultGrid" Visibility="Collapsed">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <TextBlock Text="KẾT QUẢ BÌNH CHỌN" Style="{StaticResource MaterialDesignHeadline6TextBlock}" Margin="0,0,0,8"/>
            <TextBlock x:Name="ResultQuestionText" Text="Câu hỏi..." FontSize="16" Foreground="Gray" TextWrapping="Wrap" Margin="0,0,0,16"/>

            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                <ItemsControl x:Name="ResultList">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Grid Margin="0,0,0,16">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="{Binding Text}" FontWeight="Bold"/>
                                    <TextBlock Grid.Column="1" Text="{Binding VoteCountString}"/>
                                </Grid>
                                <ProgressBar Grid.Row="1" Value="{Binding Percentage}" Height="10"
                                             Margin="0,4,0,0" Foreground="{DynamicResource PrimaryHueMidBrush}"/>
                            </Grid>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </ScrollViewer>

            <TextBlock Grid.Row="2" x:Name="TotalVotesText" Text="Tổng số phiếu: 0" FontStyle="Italic" HorizontalAlignment="Right" Margin="0,8"/>

            <Button Grid.Row="3" Content="KẾT THÚC BÌNH CHỌN" Click="StopPoll_Click"
                    Style="{StaticResource MaterialDesignRaisedButton}" Background="#F44336" BorderBrush="#F44336" HorizontalAlignment="Center"/>
        </Grid>
    </Grid>
</Window>
