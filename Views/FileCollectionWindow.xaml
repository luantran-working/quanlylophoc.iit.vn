<Window x:Class="ClassroomManagement.Views.FileCollectionWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        Title="Thu Thập File" Height="500" Width="800"
        WindowStartupLocation="CenterOwner"
        TextElement.Foreground="{DynamicResource MaterialDesignBody}"
        Background="{DynamicResource MaterialDesignPaper}"
        FontFamily="{materialDesign:MaterialDesignFont}">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <materialDesign:ColorZone Mode="PrimaryMid" Padding="16" materialDesign:ElevationAssist.Elevation="Dp4">
            <StackPanel Orientation="Horizontal">
                <materialDesign:PackIcon Kind="FolderDownload" Foreground="white" Width="24" Height="24" VerticalAlignment="Center"/>
                <TextBlock VerticalAlignment="Center" Text="THU THẬP TÀI LIỆU HỌC SINH"
                           Margin="16,0,0,0" Foreground="white" FontWeight="Bold" Style="{StaticResource MaterialDesignHeadline6TextBlock}"/>
            </StackPanel>
        </materialDesign:ColorZone>

        <!-- Settings -->
        <materialDesign:Card Grid.Row="1" Margin="16">
            <StackPanel Margin="16">
                <Grid Margin="0,0,0,16">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="160"/>
                    </Grid.ColumnDefinitions>

                    <TextBox x:Name="SourcePathBox"
                             Style="{StaticResource MaterialDesignOutlinedTextBox}"
                             materialDesign:TextFieldAssist.HasLeadingIcon="True"
                             materialDesign:TextFieldAssist.LeadingIcon="Folder"
                             materialDesign:HintAssist.Hint="Đường dẫn thư mục nguồn trên máy học sinh (VD: Documents, Desktop...)"
                             Text="Documents" BorderBrush="#E0E0E0" Padding="12,10" Margin="8,0"
                             FontSize="14" Height="48" VerticalAlignment="Bottom"/>

                    <CheckBox x:Name="RecursiveCheck" Content="Quét thư mục con" IsChecked="True" Grid.Column="1" VerticalAlignment="Bottom"/>
                </Grid>

                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="160"/>
                    </Grid.ColumnDefinitions>

                    <TextBox x:Name="ExtensionsBox"
                             Style="{StaticResource MaterialDesignOutlinedTextBox}"
                             materialDesign:TextFieldAssist.HasLeadingIcon="True"
                             materialDesign:TextFieldAssist.LeadingIcon="FileDocument"
							 materialDesign:HintAssist.Hint="Định dạng các tập tin, cách nhau bởi dấu phẩy..."
							 BorderBrush="#E0E0E0" Padding="12,10"
                             Text="doc,docx,xls,xlsx,ppt,pptx,pdf,txt,cpp,cs,py" Margin="8,0"
                             FontSize="14" Height="48"/>

                    <Button Grid.Column="1" Content="Bắt đầu thu thập" Foreground="white" Click="StartCollection_Click"
                            Style="{StaticResource MaterialDesignRaisedButton}" VerticalAlignment="Bottom"/>
                </Grid>
            </StackPanel>
        </materialDesign:Card>

        <!-- Student List & Status -->
        <DataGrid Grid.Row="2" x:Name="StudentGrid" AutoGenerateColumns="False" IsReadOnly="True"
                  Margin="16,0,16,16" HeadersVisibility="Column" SelectionMode="Single"
                  AlternatingRowBackground="#F9F9F9" GridLinesVisibility="Horizontal">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Học sinh" Binding="{Binding DisplayName}" Width="200" FontWeight="Bold"/>
                <DataGridTextColumn Header="Trạng thái thu thập" Binding="{Binding CollectionStatus}" Width="*"/>
                <DataGridTemplateColumn Header="Tình trạng" Width="100">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                             <materialDesign:PackIcon Kind="Circle" HorizontalAlignment="Center">
                                 <materialDesign:PackIcon.Style>
                                     <Style TargetType="materialDesign:PackIcon">
                                         <Setter Property="Foreground" Value="Gray"/>
                                         <Style.Triggers>
                                             <DataTrigger Binding="{Binding IsOnline}" Value="True">
                                                 <Setter Property="Foreground" Value="#4CAF50"/>
                                             </DataTrigger>
                                         </Style.Triggers>
                                     </Style>
                                 </materialDesign:PackIcon.Style>
                             </materialDesign:PackIcon>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>

        <!-- Footer -->
        <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Right" Margin="16">
            <Button Style="{StaticResource MaterialDesignOutlinedButton}" Content="Mở thư mục lưu file"
                    Click="OpenFolder_Click" Margin="0,0,8,0"/>
        </StackPanel>
    </Grid>
</Window>
